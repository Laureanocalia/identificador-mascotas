<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test Identificador</title>
</head>
<body>

  <h2>Test Identificador ğŸ¾</h2>

  <input id="codigo" placeholder="CÃ³digo">
  <button id="btn">Consultar</button>

  <div id="resultado">Esperandoâ€¦</div>

  <script>
    console.log("SCRIPT CARGADO");

    const API_URL = "https://script.google.com/macros/s/AKfycbx25qNnfQYhGPOU_nccRnZidCsY-BRVbzg0tu5J7kZq3XPQ_TEG2dDQ7d-gvB8P5ZPShg/exec";

    function validar() {
      console.log("VALIDAR EJECUTADA");

      const codigo = document.getElementById("codigo").value;
      const resultado = document.getElementById("resultado");

      resultado.textContent = "Consultando...";

      fetch(API_URL + "?code=" + encodeURIComponent(codigo))
        .then(r => r.json())
        .then(data => {
          console.log("DATA:", data);

          if (!data.exists) {
            resultado.textContent = "CÃ³digo no existe";
            return;
          }

          if (data.status === "NO_ACTIVADO") {
            resultado.textContent = "CÃ³digo NO ACTIVADO";
            return;
          }

          resultado.textContent = "Estado desconocido";
        })
        .catch(err => {
          console.error(err);
          resultado.textContent = "Error fetch";
        });
    }

    // ğŸ”¥ fuerza el binding del botÃ³n
    document.getElementById("btn").addEventListener("click", validar);
  </script>

</body>
</html>

